# Восстановление золота из руды

## Краткое описание задачи
Необходимо подготовить прототип модели машинного обучения для «Цифры». Компания разрабатывает решения для эффективной работы промышленных предприятий.

Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Использованы данные с параметрами добычи и очистки. Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

Необходимо:
1. Подготовить данные;
2. Провести исследовательский анализ данных;
3. Построить и обучить модель.

При выполнении проекта использовать библиотеки *pandas*, *matplotlib*, *seaborn* и *sklearn.*

## Технологический процесс
Когда добытая руда проходит первичную обработку, получается дроблёная смесь. Её отправляют на флотацию (обогащение) и двухэтапную очистку.

Стадии тех. процесса: 
1. **Флотация.**<br>
Во флотационную установку подаётся смесь золотосодержащей руды. После обогащения получается черновой концентрат и «отвальные хвосты», то есть остатки продукта с низкой концентрацией ценных металлов.
На стабильность этого процесса влияет непостоянное и неоптимальное физико-химическое состояние флотационной пульпы (смеси твёрдых частиц и жидкости).
2. **Очистка.**<br>
Черновой концентрат проходит две очистки. На выходе получается финальный концентрат и новые отвальные хвосты.

## Описание данных
Технологический процесс
- `Rougher feed` — исходное сырье
- `Rougher additions` (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
- `Xanthate` — ксантогенат (промотер, или активатор флотации);
- `Sulphate` — сульфат (на данном производстве сульфид натрия);
- `Depressant` — депрессант (силикат натрия).
- `Rougher process` (англ. «грубый процесс») — флотация
- `Rougher tails` — отвальные хвосты
- `Float banks` — флотационная установка
- `Cleaner process` — очистка
- `Rougher Au` — черновой концентрат золота
- `Final Au` — финальный концентрат золота

Параметры этапов
- `air amount` — объём воздуха
- `fluid levels` — уровень жидкости
- `feed size` — размер гранул сырья
- `feed rate` — скорость подачи

Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей. Также в тестовом наборе нет целевых признаков.

Исходный датасет содержит обучающую и тестовую выборки со всеми признаками.<br>
В нашем распоряжении сырые данные: их просто выгрузили из хранилища.

## Наименование признаков
Наименование признаков должно быть такое:

`[этап].[тип_параметра].[название_параметра]`

Пример: `rougher.input.feed_ag`

- Возможные значения для блока `[этап]`:
    - `rougher` — флотация
    - `primary_cleaner` — первичная очистка
    - `secondary_cleaner` — вторичная очистка
    - `final` — финальные характеристики<br><br>

- Возможные значения для блока `[тип_параметра]`:
    - `input` — параметры сырья
    - `output` — параметры продукта
    - `state` — параметры, характеризующие текущее состояние этапа
    - `calculation` — расчётные характеристики

## Расчёт эффективности
Эффективность обогащения рассчитывается по формуле:

$$ Recovery = \frac {C \cdot (F - T)} {F \cdot (C - T)} * 100 \% $$

где:

$C$ — доля золота в концентрате после флотации/очистки;<br>
$F$ — доля золота в сырье/концентрате до флотации/очистки;<br>
$T$ — доля золота в отвальных хвостах после флотации/очистки.<br>


Для прогноза коэффициента нужно найти долю золота в концентратах и хвостах. Причём важен не только финальный продукт, но и черновой концентрат.

## Метрика качества
Метрика качества в задаче — *sMAPE* (англ. Symmetric Mean Absolute Percentage Error, «симметричное среднее абсолютное процентное отклонение»).

Нужно спрогнозировать сразу две величины:
- Эффективность обогащения чернового концентрата `rougher.output.recovery`;
- Эффективность обогащения финального концентрата `final.output.recovery`.

Итоговая метрика складывается из двух величин:
$$ Итоговая \ sMAPE = 25\% \cdot sMAPE(rougher) + 75\% \cdot sMAPE(final) $$